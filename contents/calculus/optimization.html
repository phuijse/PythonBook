

<!DOCTYPE html>


<html lang="es" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>22. Optimización matemática &#8212; Computación Científica con Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contents/calculus/optimization';</script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="23. Ecuaciones Diferenciales Ordinarias" href="ode_integration.html" />
    <link rel="prev" title="21. Problema de los valores y vectores propios" href="../linalg/eigvals.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="es"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Saltar al contenido principal</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
  
    <p class="title logo__title">Computación Científica con Python</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introducción</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../preliminaries/intro.html">1. Computación científica y ciencia de datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminaries/python3.html">2. Repaso de Python 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminaries/env_management.html">3. Administración de ambientes y librerías</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminaries/git.html">4. Control de versiones</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Ambiente jupyter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../jupyter/intro.html">5. ¿Qué es Jupyter?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter/tutorial.html">6. Breve tutorial de Jupyter/IPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter/ipython_display.html">7. Módulo  <code class="docutils literal notranslate"><span class="pre">IPython.display</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter/beyond_python.html">8. Otros lenguajes en Jupyter</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Análisis de datos con Pandas</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../pandas/part1.html">9. DataFrames de <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../pandas/part2.html">10. Importar y exportar datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pandas/part3.html">11. Operaciones avanzadas con DataFrames</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pandas/part4.html">12. Tópicos extra</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualización de datos con Matplotlib</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../visualization/matplotlib1.html">13. Introducción a Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/matplotlib2.html">14. Tipos de gráfico en matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/goodvisualizations.html">15. ¿Cómo hacer buenas visualizaciones?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/ipywidgets.html">16. Interfaces de usuario en Jupyter con <code class="docutils literal notranslate"><span class="pre">ipywidgets</span></code></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Matemática computacional con Numpy y Scipy</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../numpy/numpy1.html">17. Arreglos n-dimensionales con NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../numpy/numpy2.html">18. Operaciones sobre ndarrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linalg/intro.html">19. Intuiciones geométricas de álgeba lineal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linalg/linalg1.html">20. Resolviendo sistemas de ecuaciones lineales</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linalg/eigvals.html">21. Problema de los valores y vectores propios</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">22. Optimización matemática</a></li>
<li class="toctree-l1"><a class="reference internal" href="ode_integration.html">23. Ecuaciones Diferenciales Ordinarias</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Estadística con Scipy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../statistics/intro.html">24. Introducción y fundamentos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../statistics/distributions.html">25. Distribuciones de probabilidad</a></li>
<li class="toctree-l1"><a class="reference internal" href="../statistics/descriptive.html">26. Estadística descriptiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../statistics/model_fitting.html">27. Estadística inferencial: Ajuste de Modelos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../statistics/hypothesis.html">28. Test de hipótesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../statistics/bootstrap.html">29. Intervalos de confianza con <em>Bootstrap</em></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Alto rendimiento en Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../hpc/intro.html">30. Python y  Rendimiento</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hpc/profiling.html">31. Profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hpc/opti1.html">32. Optimizando código Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hpc/cython.html">33. Acelerando Python con Cython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hpc/parallel.html">34. Computación paralela en Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Aprendizaje de máquinas con Scikit-Learn</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sklearn/intro.html">35. Machine Learning: Conceptos clave</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sklearn/pca.html">36. Reducción de dimensionalidad con PCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sklearn/kmeans.html">37. Clustering con algoritmo K-means</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sklearn/naivebayes.html">38. Clasificador Bayesiano “Ingenuo”</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/phuijse/PythonBook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Repositorio de origen"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/phuijse/PythonBook/issues/new?title=Issue%20on%20page%20%2Fcontents/calculus/optimization.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Abrir un problema"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Descarga esta pagina">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/contents/calculus/optimization.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Descargar archivo fuente"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimir en PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Modo de pantalla completa"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="claro/oscuro" aria-label="claro/oscuro" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Optimización matemática</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenido </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelamiento-matematico-de-un-problema">22.1. Modelamiento matemático de un problema</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reconocer-y-clasificar-problemas-de-optimizacion">22.2. Reconocer y clasificar problemas de optimización</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resolviendo-problemas-de-optimizacion">22.3. Resolviendo problemas de optimización</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solucion-de-fuerza-bruta">22.3.1. Solución de fuerza bruta</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solucion-analitica">22.3.2. Solución analítica</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solucion-iterativa-metodo-de-newton-y-gradiente-descedente">22.3.3. Solución iterativa: Método de Newton y Gradiente Descedente</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tutorial-de-scipy-optimize">22.4. Tutorial de <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-para-optimizacion-sin-restricciones">22.4.1. Métodos para optimización sin restricciones</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-para-optimizacion-con-restricciones">22.4.2. Métodos para optimización con restricciones</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mas-alla-de-esta-leccion">22.5. Más allá de esta lección</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="optimizacion-matematica">
<h1><span class="section-number">22. </span>Optimización matemática<a class="headerlink" href="#optimizacion-matematica" title="Permalink to this heading">#</a></h1>
<p>¿Qué significa <a class="reference external" href="https://dle.rae.es/%C3%B3ptimo">óptimo</a>?</p>
<blockquote>
<div><p>Sumamente bueno, que no puede ser mejor</p>
</div></blockquote>
<p>Pero el significado de “mejor” depende de la situación. Considere por ejemplo el problema de escoger la ruta que debe tomar un vehículo de reparto de carga</p>
<p>La “mejor” ruta pudiera ser</p>
<ul class="simple">
<li><p>la ruta más rápida</p></li>
<li><p>la ruta más barata</p></li>
<li><p>la ruta más directa</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>Para encontrar la mejor ruta primero debemos definir el <strong>criterio</strong> en que basaremos nuestra decisión</p>
</div>
<p>En el ejemplo anterior tenemos</p>
<ul class="simple">
<li><p>la ruta de mínimo <strong>tiempo</strong></p></li>
<li><p>la ruta de mínimo <strong>costo</strong></p></li>
<li><p>la ruta de mínima <strong>distancia</strong></p></li>
</ul>
<p>La selección de la mejor ruta es un ejemplo de <strong>optimización</strong>. Más en general, la optimización es:</p>
<blockquote>
<div><p>El proceso de encontrar la mejor solución para un problema dentro de un conjunto de posibilidades</p>
</div></blockquote>
<p>La optimización es un área bastante estudiada de las matemáticas y algunos problemas de optimización requieren de soluciones muy específicas</p>
<p>El objetivo de esta lección es entregar una revisión general a los problemas de optimización que podemos resolver usando las herramientas del módulo <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span>
</pre></div>
</div>
</div>
</div>
<section id="modelamiento-matematico-de-un-problema">
<h2><span class="section-number">22.1. </span>Modelamiento matemático de un problema<a class="headerlink" href="#modelamiento-matematico-de-un-problema" title="Permalink to this heading">#</a></h2>
<p>Para encontrar la mejor solución de un problema debemos primero modelarlo matemáticamente. En su forma más básica esto significa escribir el criterio de decisión como una función</p>
<blockquote>
<div><p>Llamamos a esta función, la <strong>función objetivo</strong> del problema</p>
</div></blockquote>
<p>Para el problema del vehículo de reparto que comentamos en la introducción, si tenemos una variable <span class="math notranslate nohighlight">\(x\)</span> que define la ruta y una función <span class="math notranslate nohighlight">\(f(x)\)</span> que retorna el tiempo de dicha ruta, podemos escribir</p>
<div class="math notranslate nohighlight">
\[
\min_x f(x)
\]</div>
<p>Supongamos ahora que el vehículo debe pasar por un cierto punto de la ciudad durante el reparto. La mejor ruta es ahora la de mínimo tiempo que además pasa por ese punto</p>
<blockquote>
<div><p>Llamamos <strong>restricciones</strong>, a las condiciones adicionales que debe cumplir la mejor solución</p>
</div></blockquote>
<p>Incluyendo restricciones el modelo matemático de nuestro problema sería</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
\min_x &amp;f(x)  \\
\text{sujeto a: } &amp; g_i(x) = 0, i=1,2\ldots, I \\  
&amp; h_j(x) \leq 0, j=1,2,\ldots J 
\end{split}
\end{split}\]</div>
<p>donde</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x \in \mathbb{R}^D\)</span> son las <strong>variables de decisión</strong></p></li>
<li><p><span class="math notranslate nohighlight">\(f : \mathbb{R}^D \to \mathbb{R}\)</span> es la <strong>función objetivo</strong></p></li>
<li><p><span class="math notranslate nohighlight">\(g_i : \mathbb{R}^D \to \mathbb{R}\)</span> son las <strong>restricciones de igualdad</strong></p></li>
<li><p><span class="math notranslate nohighlight">\(h_j : \mathbb{R}^D \to \mathbb{R}\)</span> son las <strong>restricciones de desigualdad</strong></p></li>
</ul>
<blockquote>
<div><p>Optimizar es el proceso de encontrar el valor óptimo (mínimo) de la función objetivo en el espacio definido por las restricciones</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En algunos problemas podríamos necesitar un máximo en lugar de un mínimo de la función objetivo</p>
</div>
<p>Sin embargo considere que</p>
<div class="math notranslate nohighlight">
\[
\max_x f(\vec x) \equiv \min_x - f(\vec x),
\]</div>
<p>Por lo que podemos hablar de minimización sin pérdida de generalidad</p>
</section>
<section id="reconocer-y-clasificar-problemas-de-optimizacion">
<h2><span class="section-number">22.2. </span>Reconocer y clasificar problemas de optimización<a class="headerlink" href="#reconocer-y-clasificar-problemas-de-optimizacion" title="Permalink to this heading">#</a></h2>
<p>Estudiando algunas características del problema podemos seleccionar más fácilmente un algoritmo  apropiado para resolverlo. Algunas preguntas guía que podemos realizar son</p>
<p>¿Es mi función objetivo de una variable (<span class="math notranslate nohighlight">\(D=1\)</span>) versus multi-variable (<span class="math notranslate nohighlight">\(D&gt;1\)</span>)?</p>
<blockquote>
<div><p>Esto define la dimensionalidad o escala del problema</p>
</div></blockquote>
<p>¿Existen restricciones de igualidad y/o desigualidad que debo cumplir?</p>
<blockquote>
<div><p>Algunos algoritmos sólo pueden resolver problemas sin restricciones</p>
</div></blockquote>
<p>¿Es mi función objetivo lineal o no lineal con respecto a la entrada?</p>
<blockquote>
<div><p>Si todas las funciones son lineales entonces se pueden usar técnicas de <strong>programación lineal</strong>. Esto problemas son más simples que los no lineales</p>
</div></blockquote>
<p>¿Es mi función objetivo convexa o no convexa?</p>
<img alt="../../_images/opti1.png" src="../../_images/opti1.png" />
<blockquote>
<div><p>Una función no-convexa (derecha) puede tener múltiples mínimos locales. Por el contrario una función convexa (izquierda) tiene un único mínimo</p>
</div></blockquote>
<p>¿Es mi función objetivo continua y diferenciable o no-diferenciable?</p>
<blockquote>
<div><p>Si la función no es continua entonces no puedo calcular su gradiente. Muchos métodos se basan en el gradiente para encontrar óptimos</p>
</div></blockquote>
</section>
<section id="resolviendo-problemas-de-optimizacion">
<h2><span class="section-number">22.3. </span>Resolviendo problemas de optimización<a class="headerlink" href="#resolviendo-problemas-de-optimizacion" title="Permalink to this heading">#</a></h2>
<section id="solucion-de-fuerza-bruta">
<h3><span class="section-number">22.3.1. </span>Solución de fuerza bruta<a class="headerlink" href="#solucion-de-fuerza-bruta" title="Permalink to this heading">#</a></h3>
<p>La forma más “simple” de resolver un problema de optimización es la <strong>fuerza bruta</strong>, es decir evaluar <span class="math notranslate nohighlight">\(f(x)\)</span>, <span class="math notranslate nohighlight">\(g_i(x)\)</span> y <span class="math notranslate nohighlight">\(h_j(x)\)</span> exhaustivamente para todos los valores de <span class="math notranslate nohighlight">\(x\)</span> hasta encontrar el mejor</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Si <span class="math notranslate nohighlight">\(x\)</span> fuera una variable continua necesitariamos discretizarla para crear una grilla de búsqueda</p>
</div>
<p>La ventaja del método de fuerza bruta es que si la grilla es lo suficientemente fina entonces el método no confudirá un mínimo local con el mínimo global</p>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>El método de fuerza bruta es ingenuo pues se vuelve enormemente ineficiente a medida que crece el rango y la dimensionalidad de <span class="math notranslate nohighlight">\(x\)</span></p>
</div>
</section>
<section id="solucion-analitica">
<h3><span class="section-number">22.3.2. </span>Solución analítica<a class="headerlink" href="#solucion-analitica" title="Permalink to this heading">#</a></h3>
<p>Si nuestra función es continua y derivable podemos intentar encontrar una solución analítica igualando su gradiente a cero, es decir</p>
<div class="math notranslate nohighlight">
\[
\nabla f (x^*) = \begin{pmatrix} \frac{\partial f}{\partial x_1}, \frac{\partial f}{\partial x_2}, \ldots, \frac{\partial f}{\partial x_D} \end{pmatrix} = \vec 0
\]</div>
<p>Estas soluciones se conocen como <strong>puntos estacionarios</strong> de <span class="math notranslate nohighlight">\(f\)</span>, que incluyen los mínimos, máximos y puntos silla</p>
<p>Para comprobar que el punto estacionario es un mínimo primero calculamos la matriz Hessiana <span class="math notranslate nohighlight">\(H\)</span> donde sus componentes son</p>
<div class="math notranslate nohighlight">
\[
H_{ij}  = \frac{\partial^2 f}{\partial x_i \partial x_j}
\]</div>
<p>Luego si el Hessiano evaluado en <span class="math notranslate nohighlight">\(x^*\)</span> es definido positivo</p>
<div class="math notranslate nohighlight">
\[
x^T H(x^*) x &gt; 0 ~ \forall x,
\]</div>
<p>entonces <span class="math notranslate nohighlight">\(x^*\)</span> es un <strong>mínimo</strong></p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Si el problema tiene restricciones podríamos incluirlas utilizando multiplicadores de Lagrange</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>En muchos casos prácticos <span class="math notranslate nohighlight">\(f(x)\)</span> es demasiado complicada como para despejar una expresión análitica de <span class="math notranslate nohighlight">\(x\)</span> a partir de <span class="math notranslate nohighlight">\(\nabla f (x^*)=0\)</span></p>
</div>
</section>
<section id="solucion-iterativa-metodo-de-newton-y-gradiente-descedente">
<h3><span class="section-number">22.3.3. </span>Solución iterativa: Método de Newton y Gradiente Descedente<a class="headerlink" href="#solucion-iterativa-metodo-de-newton-y-gradiente-descedente" title="Permalink to this heading">#</a></h3>
<p>Si evaluar el espacio de soluciones completo es infactible podríamos intentar explorarlo de forma parcial con un método iterativo</p>
<p>Los métodos iterativos parten de una o varias “soluciones iniciales” y luego aplican criterios que las “mejoran” paso a paso, acercándolas a la solución óptima</p>
<p>Sea <span class="math notranslate nohighlight">\(x_t\)</span> el valor actual de la variable de decisión. Podemos escribir el valor que tendrá en el siguiente paso como</p>
<div class="math notranslate nohighlight">
\[
x_{t+1} = x_t + \Delta x
\]</div>
<p>y lo que queremos es encontrar el mejor <span class="math notranslate nohighlight">\(\Delta x\)</span> según nuestra función objetivo <span class="math notranslate nohighlight">\(f(x)\)</span>. Para continuar consideremos la aproximación de Taylor de segundo orden de <span class="math notranslate nohighlight">\(f\)</span> en torno a <span class="math notranslate nohighlight">\(x_{t+1}\)</span></p>
<div class="math notranslate nohighlight">
\[
f(x_{t} + \Delta x) \approx f(x_t) + \nabla f (x_t) \Delta x + \frac{1}{2} \Delta x^T H_f (x_t) \Delta x 
\]</div>
<p>Luego, si derivamos en función de <span class="math notranslate nohighlight">\(\Delta x\)</span> e igualamos a cero se tiene que</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\nabla f (x_t)  +  H_f (x_t) \Delta x &amp;= 0 \nonumber \\
\Delta x &amp;= - [H_f (x_t)]^{-1}\nabla f (x_t)  \nonumber \\
x_{t+1} &amp;= x_{t} - [H_f (x_t)]^{-1}\nabla f (x_t)  \nonumber 
\end{align}
\end{split}\]</div>
<p>Que se conoce como <strong>la regla iterativa de Newton</strong> y donde</p>
<ul class="simple">
<li><p>El gradiente <span class="math notranslate nohighlight">\(\nabla f (x_t)\)</span> nos indica la dirección en que debemos desplazarnos</p></li>
<li><p>El hessiano <span class="math notranslate nohighlight">\(H_f (x_t)\)</span> nos indica la distancia que debemos desplazarnos</p></li>
</ul>
<div class="admonition caution">
<p class="admonition-title">Prudencia</p>
<ul class="simple">
<li><p>Usando Newton estamos asumiendo que la aproximación de segundo orden de <span class="math notranslate nohighlight">\(f\)</span> es buena</p></li>
<li><p>La solución del método de Newton depende de <span class="math notranslate nohighlight">\(x_0\)</span> (solución inicial). Es conveniente probar varios valores de <span class="math notranslate nohighlight">\(x_0\)</span></p></li>
<li><p>Si la dimensionalidad de <span class="math notranslate nohighlight">\(x\)</span> es grande, invertir el hessiano (matriz de <span class="math notranslate nohighlight">\(M\times M\)</span>) puede ser costoso</p></li>
</ul>
</div>
<p>Si el Hessiano es prohibitivo podemos usar una aproximación de primer orden de la regla de Newton. Esto resulta en el clásico método conocido como  <strong>gradiente descendente</strong></p>
<div class="math notranslate nohighlight">
\[
x_{t+1} = x_{t} - \eta \nabla f (x_t)
\]</div>
<p>donde se reemplaza el Hessiano por una constante <span class="math notranslate nohighlight">\(\eta\)</span> llamado “paso” o “tasa de aprendizaje”.</p>
<p>Es importante calibrar adecuadamente <span class="math notranslate nohighlight">\(\eta\)</span>. Si es muy grande la adaptación será inestable, y si es muy pequeño demoraremos demasiado en llegar al óptimo. La siguiente figura lo ejemplifica</p>
<a class="reference internal image-reference" href="../../_images/opti2.png"><img alt="../../_images/opti2.png" src="../../_images/opti2.png" style="width: 700px;" /></a>
</section>
</section>
<section id="tutorial-de-scipy-optimize">
<h2><span class="section-number">22.4. </span>Tutorial de <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code><a class="headerlink" href="#tutorial-de-scipy-optimize" title="Permalink to this heading">#</a></h2>
<p>Podemos realizar optimización matemática utilizando el módulo <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html"><code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a>. La función principal de este módulo es <code class="docutils literal notranslate"><span class="pre">minimize</span></code> la cual engloba a una larga lista de métodos de optimización</p>
<p>Los argumentos esta función son</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>
<span class="n">minimize</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="c1"># Función objetivo </span>
         <span class="n">x0</span><span class="p">,</span> <span class="c1"># Valor inicial de la variable de decisión</span>
         <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="c1"># Argumentos adicionales de fun</span>
         <span class="n">method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># El método de optimización a usar </span>
         <span class="n">jac</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># Función que calcula la matriz de primeras derivadas (jacobiano)</span>
         <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># Secuencia de tuplas (min, max) con cotas para x </span>
         <span class="n">constraints</span><span class="o">=</span><span class="p">(),</span> <span class="c1"># Diccinario o lista de restricciones (más detalles a continuación)</span>
         <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># Tolerancia para el término de la optimización</span>
         <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># Una función que se ejecuta luego de cada iteración</span>
         <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># Diccionario con las opciones especificas para cada método</span>
         <span class="o">...</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>Para utilizar <code class="docutils literal notranslate"><span class="pre">minimize</span></code> la función objetivo debe estar definida de la siguiente forma</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">foo</span>
</pre></div>
</div>
<p>donde</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> debe ser un escalar o un ndarray</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">foo</span></code> debe ser un valor escalar flotante</p></li>
<li><p>Los argumentos adicionales a <code class="docutils literal notranslate"><span class="pre">x</span></code> se deben desempaquetar de la tupla <code class="docutils literal notranslate"><span class="pre">args</span></code></p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Si el problema a resolver es de maximización, debemos convertirlo a un problema de minimización antes de usar <code class="docutils literal notranslate"><span class="pre">minimize</span></code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Si no se especifica <code class="docutils literal notranslate"><span class="pre">method</span></code> se utiliza por defecto <a class="reference external" href="https://es.wikipedia.org/wiki/L-BFGS">BFGS</a>, un método de tipo quasi-Newton que utiliza el gradiente de la función objetivo y una aproximación del inverso de su Hessiano</p>
</div>
<p><strong>Ejemplo</strong></p>
<p>Sea la siguiente función objetivo con variable de decisión escalar</p>
<div class="math notranslate nohighlight">
\[
f(x) = x^2 - 2x + 5 \sin(2x)
\]</div>
<p>Para optimizarla con <code class="docutils literal notranslate"><span class="pre">scipy</span></code> primero debemos definirla:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Luego la optimizamos con <code class="docutils literal notranslate"><span class="pre">minimize</span></code> especificando como mínimo la función misma y una solución inicial</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">solution</span></code> es un objeto de tipo <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.OptimizeResult.html#scipy.optimize.OptimizeResult"><code class="docutils literal notranslate"><span class="pre">OptimizeResult</span></code></a>, cuyos atributos más importantes son</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>: Mejor valor encontrado de la variable de decisión</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fun</span></code>: Valor de la función objetivo en el óptimo encontrado</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jac</span></code>: Valor de la matriz de primeras derivadas en el óptimo encontrado</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">success</span></code>: Booleano que indica si la optimización se llevó a cabo con exito</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">message:</span></code> Mensaje indicando la razón de término, útil para debuggear</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solution</span><span class="o">.</span><span class="n">message</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Optimization terminated successfully.&#39;
</pre></div>
</div>
</div>
</div>
<p>Si visualizamos la solución con <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_plot</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="n">solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">x0</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> 
         <span class="n">head_width</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Variable de decisión&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Función objetivo&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c091dd002a4b9ac3d1c24f0338d06ad638537be517f0b5628c942cd71acb544f.png" src="../../_images/c091dd002a4b9ac3d1c24f0338d06ad638537be517f0b5628c942cd71acb544f.png" />
</div>
</div>
<blockquote>
<div><p>La función es no convexa y el método quasi-Newton ha encontrado un mínimo local</p>
</div></blockquote>
<div class="admonition hint">
<p class="admonition-title">Consejo</p>
<p>En problemas no-convexos es conveniente probar distintas soluciones iniciales</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">solution</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x0_</span> <span class="ow">in</span> <span class="n">x0</span><span class="p">:</span>
    <span class="n">solution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0_</span><span class="p">))</span>
    
<span class="n">bests</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">solution</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">solution</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_plot</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;solución inicial&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x0_</span><span class="p">,</span> <span class="n">best</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">bests</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x0_</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x0_</span><span class="p">),</span> <span class="n">best</span><span class="o">-</span><span class="n">x0_</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">best</span><span class="p">)</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x0_</span><span class="p">),</span> 
             <span class="n">head_width</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Variable de decisión&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Función objetivo&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9f0c6d6165614317360256b71666a87b8ee952ef65fc29d6c7db3e96e46f1ee5.png" src="../../_images/9f0c6d6165614317360256b71666a87b8ee952ef65fc29d6c7db3e96e46f1ee5.png" />
</div>
</div>
<p>El argumento <code class="docutils literal notranslate"><span class="pre">jac</span></code> de <code class="docutils literal notranslate"><span class="pre">minimize</span></code> espera la función de primeras derivadas o vector jacobiano. Este debe seguir una forma similar a la función objetivo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">jac</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">dfoo</span> 
</pre></div>
</div>
<p>donde</p>
<ul class="simple">
<li><p>donde <code class="docutils literal notranslate"><span class="pre">x</span></code> y <code class="docutils literal notranslate"><span class="pre">args</span></code> deben coincidir con <code class="docutils literal notranslate"><span class="pre">fun</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dfoo</span></code> debe tener la misma dimensionalidad de <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
</ul>
<p>Si no se especifica <code class="docutils literal notranslate"><span class="pre">jac</span></code> las derivadas se calcularán de forma numérica, lo cual es menos eficiente</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="o">%</span><span class="k">timeit</span> -r10 -n10 scipy.optimize.minimize(f, 0.0)
<span class="o">%</span><span class="k">timeit</span> -r10 -n10 scipy.optimize.minimize(f, 0.0, jac=df)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.4 ms ± 318 µs per loop (mean ± std. dev. of 10 runs, 10 loops each)
1.09 ms ± 29.4 µs per loop (mean ± std. dev. of 10 runs, 10 loops each)
</pre></div>
</div>
</div>
</div>
<p>A continuación describiremos algunos de los métodos disponibles a través del argumento <code class="docutils literal notranslate"><span class="pre">method</span></code> de <code class="docutils literal notranslate"><span class="pre">minimize</span></code></p>
<section id="metodos-para-optimizacion-sin-restricciones">
<h3><span class="section-number">22.4.1. </span>Métodos para optimización sin restricciones<a class="headerlink" href="#metodos-para-optimizacion-sin-restricciones" title="Permalink to this heading">#</a></h3>
<p>Con estos métodos no se pueden especificar los argumentos <code class="docutils literal notranslate"><span class="pre">constraint</span></code> y/o <code class="docutils literal notranslate"><span class="pre">bounds</span></code>.</p>
<p>Por ejemplo están</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-cg.html#optimize-minimize-cg"><code class="docutils literal notranslate"><span class="pre">method=CG</span></code></a>: Gradiente conjugado. Es una versión de GD con tasa de aprendizaje adaptiva</p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-bfgs.html#optimize-minimize-bfgs"><code class="docutils literal notranslate"><span class="pre">method=BFGS</span></code></a>: Es un método de tipo <a class="reference external" href="https://en.wikipedia.org/wiki/Quasi-Newton_method">quasi-Newton</a> con Hessiano inverso aproximado a cada paso.</p></li>
</ul>
<p>Los cuales usan gradientes, ya sea numérico o especificado mediante el argumento <code class="docutils literal notranslate"><span class="pre">jac</span></code>. Si la derivada puede obtenerse analiticamente y es confiable estos métodos tendrán un desempeño superior a las alternativas</p>
<p>Luego están</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-neldermead.html#optimize-minimize-neldermead"><code class="docutils literal notranslate"><span class="pre">method=Nelder-Mead</span></code></a>: Es una heurística tipo simplex. <a class="reference external" href="https://www.youtube.com/watch?v=HUqLxHfxWqU">Animación que muestra su funcionamiento</a></p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-powell.html#optimize-minimize-powell"><code class="docutils literal notranslate"><span class="pre">method=Powell</span></code></a>: Algoritmo de búsqueda de linea siguiendo una dirección a la vez.</p></li>
</ul>
<p>Los cuales no usan gradientes. Estos métodos pueden usarse cuando la función objetivo es no-derivable o demasiado ruidosa para ser derivada</p>
</section>
<section id="metodos-para-optimizacion-con-restricciones">
<h3><span class="section-number">22.4.2. </span>Métodos para optimización con restricciones<a class="headerlink" href="#metodos-para-optimizacion-con-restricciones" title="Permalink to this heading">#</a></h3>
<p>Con estos métodos se pueden incorporar restricciones al problema ya sea en forma de cotas para las variables o ecuaciones de igualdad/desigualdad que las variables deben cumplir</p>
<ul class="simple">
<li><p>Las restricciones de igualdad deben ser siempre de la forma <span class="math notranslate nohighlight">\(g(x) = 0\)</span></p></li>
<li><p>Las restricciones de desigualdad deben ser siempre de la forma <span class="math notranslate nohighlight">\(h(x) \geq 0 \)</span></p></li>
</ul>
<p>En la práctica las restricciones se entregan como una tupla en el argumento <code class="docutils literal notranslate"><span class="pre">constraint</span></code> de <code class="docutils literal notranslate"><span class="pre">method</span></code>. Cada restricción es un diccionario con las llaves <code class="docutils literal notranslate"><span class="pre">type</span></code> y <code class="docutils literal notranslate"><span class="pre">fun</span></code> para especificar el tipo (string <code class="docutils literal notranslate"><span class="pre">eq</span></code> o <code class="docutils literal notranslate"><span class="pre">ineq</span></code>) y la función, respectivamente. Opcionalmente se puede especificar <code class="docutils literal notranslate"><span class="pre">jac</span></code>, la matriz de primeras derivadas de <code class="docutils literal notranslate"><span class="pre">fun</span></code> y <code class="docutils literal notranslate"><span class="pre">arg</span></code> una tupla con argumentos adicionales para <code class="docutils literal notranslate"><span class="pre">fun</span></code> y <code class="docutils literal notranslate"><span class="pre">jac</span></code></p>
<p>Por ejemplo si se tiene la siguiente restricción</p>
<div class="math notranslate nohighlight">
\[
x^2 \geq 1 + 2x
\]</div>
<p>se escribe como:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;ineq&#39;</span><span class="p">,</span> 
      <span class="s1">&#39;fun&#39;</span> <span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
      <span class="s1">&#39;jac&#39;</span> <span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Si tenemos restricciones del tipo <span class="math notranslate nohighlight">\(h(x)\leq 0\)</span> debemos transformarlas a <span class="math notranslate nohighlight">\(-h(x)\geq 0\)</span> antes de implementarlas</p>
</div>
<p>Los métodos que permiten especificar restricciones son</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-lbfgsb.html"><code class="docutils literal notranslate"><span class="pre">L-BFGS-B</span></code></a>: Similar a BFGS pero permite añadir cotas (<code class="docutils literal notranslate"><span class="pre">bounds</span></code>) para la variable de decisión</p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-slsqp.html"><code class="docutils literal notranslate"><span class="pre">SLSQP</span></code></a>: <em>Sequential Least Squares Programming</em>. Este método acepta cotas, restricciones de igualdad y restricciones de desigualdad</p></li>
</ul>
<p><strong>Ejemplo</strong></p>
<p>Sea la siguiente función de costo con dos variables de decisión</p>
<div class="math notranslate nohighlight">
\[
\min f(x, y) = -(2xy+2x-x^2-2y^2) 
\]</div>
<p>sujeta a</p>
<div class="math notranslate nohighlight">
\[
x^3 - y = 0 ~\wedge~y-(x-1)^4-2 \geq 0 
\]</div>
<p>donde</p>
<div class="math notranslate nohighlight">
\[
0.5\leq x \leq 1.5 ~\wedge~ 1.5 \leq y \leq 2.5
\]</div>
<p>Resolvamos utilizando <code class="docutils literal notranslate"><span class="pre">minimize</span></code>. La solución sin considerar restricciones sería:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">solution_no_constraint</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BFGS&#39;</span><span class="p">)</span>
<span class="n">solution_no_constraint</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2., 1.])
</pre></div>
</div>
</div>
</div>
<p>La solución considerando cotas paras las variables de decisión sería:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bounds</span> <span class="o">=</span> <span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">))</span>
<span class="n">solution_with_bounds</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;L-BFGS-B&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
<span class="n">solution_with_bounds</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.5, 1.5])
</pre></div>
</div>
</div>
</div>
<p>Finalmente la solución considerando cotas y restricciones sería:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cons</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;eq&#39;</span><span class="p">,</span> 
         <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
         <span class="s1">&#39;jac&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">])</span>
        <span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;ineq&#39;</span><span class="p">,</span>
         <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span>
         <span class="s1">&#39;jac&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
        <span class="p">})</span>

<span class="n">solution_with_constraints</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;SLSQP&#39;</span><span class="p">,</span> 
                                                    <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">cons</span><span class="p">)</span>
<span class="n">solution_with_constraints</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.26089314, 2.00463288])
</pre></div>
</div>
</div>
</div>
<p>Podemos visualizar estas soluciones con <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, el color de la superficie representa la función objetivo, el área oscura las cotas y las lineas punteadas las restricciones</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">A</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">B</span><span class="o">.</span><span class="n">ravel</span><span class="p">()]))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">solution_no_constraint</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">solution_no_constraint</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
           <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;BFGS&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">solution_with_bounds</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">solution_with_bounds</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
           <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;L-BFGS-B&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">solution_with_constraints</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">solution_with_constraints</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
           <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SLSQP&#39;</span><span class="p">);</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6fb8a9494f3857804287ac7fae3ed049c9208ad743875f53663345e12a6ac595.png" src="../../_images/6fb8a9494f3857804287ac7fae3ed049c9208ad743875f53663345e12a6ac595.png" />
</div>
</div>
</section>
</section>
<section id="mas-alla-de-esta-leccion">
<h2><span class="section-number">22.5. </span>Más allá de esta lección<a class="headerlink" href="#mas-alla-de-esta-leccion" title="Permalink to this heading">#</a></h2>
<div class="admonition seealso">
<p class="admonition-title">Ver también</p>
<p>Funcionalidades de SciPy que no se exploraron en esta lección:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.root">Encontrando raices de una función</a></p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.linprog.html#scipy.optimize.linprog">Solución de problemas de programación lineal</a></p></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Tenga en cuenta las siguientes limitaciones:</p>
<ul class="simple">
<li><p>Scipy puede ser lento para problemas de gran envergadura. Si este es el caso sugiero explorar los wrappers de Python de <a class="reference external" href="https://www.cvxpy.org/">CVXOPT</a></p></li>
<li><p>Scipy no tiene optimizadores para variables de decisión discretas. En caso de necesitar utilizar un algoritmo de optimización externo/comercial (por ejemplo CPLEX, Gurobi o AMPL) , sugiero explorar la librería <a class="reference external" href="http://www.pyomo.org/documentation">Pyomo</a></p></li>
</ul>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./contents/calculus"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../linalg/eigvals.html"
       title="página anterior">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">anterior</p>
        <p class="prev-next-title"><span class="section-number">21. </span>Problema de los valores y vectores propios</p>
      </div>
    </a>
    <a class="right-next"
       href="ode_integration.html"
       title="siguiente página">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">siguiente</p>
        <p class="prev-next-title"><span class="section-number">23. </span>Ecuaciones Diferenciales Ordinarias</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenido
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelamiento-matematico-de-un-problema">22.1. Modelamiento matemático de un problema</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reconocer-y-clasificar-problemas-de-optimizacion">22.2. Reconocer y clasificar problemas de optimización</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resolviendo-problemas-de-optimizacion">22.3. Resolviendo problemas de optimización</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solucion-de-fuerza-bruta">22.3.1. Solución de fuerza bruta</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solucion-analitica">22.3.2. Solución analítica</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solucion-iterativa-metodo-de-newton-y-gradiente-descedente">22.3.3. Solución iterativa: Método de Newton y Gradiente Descedente</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tutorial-de-scipy-optimize">22.4. Tutorial de <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-para-optimizacion-sin-restricciones">22.4.1. Métodos para optimización sin restricciones</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-para-optimizacion-con-restricciones">22.4.2. Métodos para optimización con restricciones</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mas-alla-de-esta-leccion">22.5. Más allá de esta lección</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Por Pablo Huijse Heise
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>